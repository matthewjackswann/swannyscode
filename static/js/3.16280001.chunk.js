(this.webpackJsonpswannyscode=this.webpackJsonpswannyscode||[]).push([[3],{171:function(e,s,l){"use strict";l.r(s);var c,r=l(13),n=l(8),t=l(1),o=l(36),b=l(14),i=l(424),j=l.n(i),a=l(0),h=function(e,s){var l=Object(t.useState)(""),c=Object(n.a)(l,2),r=c[0],o=c[1],b=function(e){for(var s="",l=0;l<e.length;l++)s+=e.charCodeAt(l).toString(16);for(var c,r=(c=parseInt(s,16)%0x1cc71b7bf6787900,function(){return(c=1e4*Math.sin(c))-Math.floor(c)}),n="",t=0;t<8;t++)n+="abcdefghijklmnopqrstuvwxyz".charAt(Math.floor(26*r()));return n},i=r+s,j=e?r+"????????????????????????":i,h=b(i.slice(0,8))+b(i.slice(8,16))+b(i.slice(16,24));return Object(a.jsxs)("div",{children:[Object(a.jsxs)("p",{children:["Message to encrypt: ",Object(a.jsx)("input",{type:"text",value:r,onChange:function(e){return o(e.target.value.toLowerCase())}})]}),Object(a.jsxs)("table",{style:{borderSpacing:0},children:[Object(a.jsx)("colgroup",{children:Array.from(Array(24).keys()).map((function(e){var s=e>7&&e<16?"rgba(255,0,0,.25)":"rgba(0,255,0,.25)";return Object(a.jsx)("col",{style:{backgroundColor:s}},e)}))}),Object(a.jsxs)("tbody",{children:[Object(a.jsx)("tr",{children:Array.from(Array(24).keys()).map((function(e){return e>=r.length?Object(a.jsx)("td",{style:{width:"2%",padding:"0px",textAlign:"center"},children:Object(a.jsx)("b",{children:Object(a.jsx)("span",{style:{color:"red"},children:j[e]})})},e):Object(a.jsx)("td",{style:{width:"2%",padding:"0px",textAlign:"center"},children:Object(a.jsx)("b",{children:Object(a.jsx)("span",{style:{color:"blue"},children:j[e]})})},e)}))}),Object(a.jsx)("tr",{children:Array.from(Array(21).keys()).map((function(e){return(e+4)%7===0?Object(a.jsx)("td",{colSpan:"2",style:{width:"2%",padding:"0px",textAlign:"center",height:"10px"},children:Object(a.jsx)("span",{children:"\u21a7"})},e):Object(a.jsx)("td",{style:{width:"2%",padding:"0px",height:"10px"}},e)}))}),Object(a.jsx)("tr",{children:Array.from(Array(24).keys()).map((function(e){return Object(a.jsx)("td",{style:{width:"2%",padding:"0px",textAlign:"center"},children:Object(a.jsx)("b",{children:h[e]})},e)}))})]})]})]})};s.default=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"AES CBC with predictable IV"}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"This is a cryptography challenge I came across competing in a competition. We aren't allowed to share the question or solution but I enjoyed it so much I made my own version. It is still based of exploiting the same vulnerability, the predictable IV."}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"We are given a server ip address and port to connect to and the servers code."}),Object(a.jsxs)(o.a,{children:[Object(a.jsxs)("h4",{children:["server.py ",Object(a.jsx)("i",{className:"arrow down",style:{float:"right",marginRight:"10px"}})]}),Object(a.jsx)("pre",{className:"code",children:Object(a.jsxs)("code",{children:[Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"import"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" socket"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"import"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" os"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"from"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" Crypto.Cipher "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"import"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" AES"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# A different flag is used in the real server :)"})}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# the character set is uppercase letters and space."})}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# The real one is not necessarily this long."})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"FLAG "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:"b'THIS IS MY SECRET MESSAGE'"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# A different encryption key is used in the real server :)"})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"ENCRYPT_KEY "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:"b'ThisIsNotTheSecretKey...'"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"BLOCK_SIZE "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"def"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"pad_to_full_block"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"data"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"):"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"padding_len "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" BLOCK_SIZE "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"-"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" ("}),Object(a.jsx)("span",{style:{color:"rgb(1, 132, 188)"},children:"len"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(data) "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"%"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" BLOCK_SIZE)"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"return"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" data "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" str."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"encode"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(1, 132, 188)"},children:"chr"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(padding_len) "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"*"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" padding_len)"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"def"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"encrypt"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"data"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:", "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"iv"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"):"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"aes "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" AES."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"new"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(ENCRYPT_KEY, AES."}),Object(a.jsx)("span",{style:{color:"rgb(228, 86, 73)"},children:"MODE_CBC"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:", iv)"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"padded "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"pad_to_full_block"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(data)"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"return"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" aes."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"encrypt"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"pad_to_full_block"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(data))"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"HOST "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:"'127.0.0.1'"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"PORT "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"65432"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"with"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" socket."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"socket"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(socket."}),Object(a.jsx)("span",{style:{color:"rgb(228, 86, 73)"},children:"AF_INET"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:", socket."}),Object(a.jsx)("span",{style:{color:"rgb(228, 86, 73)"},children:"SOCK_STREAM"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:") "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"as"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" s:"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"s."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"bind"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"((HOST, PORT))"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"s."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"listen"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"()"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"conn, addr "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" s."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"accept"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"()"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"with"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" conn:"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(1, 132, 188)"},children:"print"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:"'Connected by'"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:", addr)"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"iv "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" os."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"urandom"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"conn."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"sendall"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(iv)"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"while"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"True"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"try"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"data "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" conn."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"recv"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"4096"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"encryptingMessage "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" data "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" FLAG"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"toSend "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"encrypt"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(encryptingMessage, iv)"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"iv "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" toSend["}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"-"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":]"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"conn."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"sendall"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(toSend)"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"except"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"break"})]})]})})]}),Object(a.jsx)("p",{children:"Looking through the code we can see that this is some form of AES encryption service using CBC. We are also given the initial IV when we first connect."}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"We can also see that there is no information given about the key used which implies that we don't want to try and guess the key and we might be able to work out the flag without the key."}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"Next it's best to look at how AES CBC works and if there are any vulnerabilities we can use."}),Object(a.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/8/80/CBC_encryption.svg",alt:"cbc structure"}),Object(a.jsx)("p",{children:"The message we want to encrypt (the plaintext) is split into blocks of 16. The first block and the IV are combined with a bitwise xor and then the result in encrypted. This result makes up the first block of the ciphertext and is used in the xor with the second block. This continues for each block until the entire plaintext is converted into ciphertext."}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"This is all the information we need to be able to crack the first part of this challenge, making the IV effectively redundant. This is done using the following property of the xor operator."}),Object(a.jsx)(b.a,{tex:String.raw(c||(c=Object(r.a)(["alpha oplus \beta = 0 Leftrightarrow alpha = \beta"],["\\alpha \\oplus \\beta = 0 \\Leftrightarrow \\alpha = \\beta"])))}),Object(a.jsx)("p",{children:"This means that if we set the first block equal to the IV then the xor of this will be 0. When this is encrypted by AES and a constant key the out put will always be the same. This then means that when the second block is combined with the ciphertext, the ciphertext is constant and we can treat the second block as the first, just now with a constant IV."}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"In summary, if we put the next IV at the start of our message to the server then the encrypted message will always be the same, removing the randomness that is usually made by the IV."}),Object(a.jsx)("br",{}),Object(a.jsxs)("p",{children:["This allows us the guess the second block. If we send ",Object(a.jsx)("b",{children:"IV"})," to the server then look at the output of the second block we have our target. We can then send ",Object(a.jsx)("b",{children:"IV + guess"})," to the server and if the second block of the ciphertext matches our target we know that our guess is correct and we can continue onto the next block until all blocks have been cracked."]}),Object(a.jsx)("br",{}),Object(a.jsxs)("p",{children:["This sounds great but even with the restricted alphabet that we are guessing for there are still ",Object(a.jsxs)("b",{children:["3.2452x10",Object(a.jsx)("sup",{children:"32"})]})," different guesses. This is way to many to guess all of them so we can reduce this by only guessing one character at a time. If you want to try and work out how it can be done quite cleverly by taking advantage of how our message is combined with the flag on the server."]}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"If you've not worked it out (or just can't be bothered) we can guess only one letter at a time by filling the rest of the plaintext with known values and having the last character of the block be the first character of the flag. Then we can guess the last character and move onto the next character."}),Object(a.jsx)("br",{}),Object(a.jsxs)("p",{children:["Example",Object(a.jsx)("br",{}),"If we send to the server the following message:"]}),Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"IV"})," + xxxxxxxxxxxxxxx"]}),Object(a.jsx)("p",{children:"Then the first two block will be the encrypted version of the plaintext"}),Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"IV"})," + xxxxxxxxxxxxxxx?"]}),Object(a.jsxs)("p",{children:["Where ",Object(a.jsx)("b",{children:"?"})," is the first character of the flag, this is our target."]}),Object(a.jsxs)("p",{children:["To find the value of ",Object(a.jsx)("b",{children:"?"})," we can next send the messages"]}),Object(a.jsxs)("p",{children:[Object(a.jsx)("b",{children:"IV"})," + xxxxxxxxxxxxxxxA, ",Object(a.jsx)("b",{children:"IV"})," + xxxxxxxxxxxxxxxB, ",Object(a.jsx)("b",{children:"IV"})," + xxxxxxxxxxxxxxxC ..."]}),Object(a.jsx)("p",{children:"As soon as the second block of ciphertext matches our target we know that our guess was correct and we can move onto the next character."}),Object(a.jsx)("br",{}),Object(a.jsxs)("p",{children:["Using this method we only have to make at most ",Object(a.jsx)(j.a,{display:"inline",latex:"\\text{alphabet size} * \\text{flag length}"}),". This is far smaller then the previous ",Object(a.jsx)(j.a,{display:"inline",latex:"\\text{block size} ^ \\text{alphabet size} * \\text{blocks in flag}"}),". We will use this method to work out what the flag is."]}),Object(a.jsx)("br",{}),Object(a.jsxs)("p",{children:["I've made an interactive example of how this process works below. It doesn't use the same encryption methods but the same methodology applies. ",Object(a.jsx)("b",{children:Object(a.jsx)("span",{style:{color:"red"},children:"Red"})})," characters and 'unknown' from the flag and ",Object(a.jsx)("b",{children:Object(a.jsx)("span",{style:{color:"blue"},children:"Blue"})})," characters are from your message input. For simplicity the ",Object(a.jsx)("b",{children:"IV"})," is fixed so can be ignored and the block size is 8 rather than the standard 16."]}),Object(a.jsx)("br",{}),h(!1,"secure super secret flag"),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"To get an understanding of how this works try entering the following while looking at the output:"}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:Object(a.jsx)("b",{children:"xxxxxxx"})}),Object(a.jsx)("li",{children:Object(a.jsx)("b",{children:"xxxxxxxs"})})]}),Object(a.jsx)("p",{children:"And then"}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:Object(a.jsx)("b",{children:"xxxxxx"})}),Object(a.jsx)("li",{children:Object(a.jsx)("b",{children:"xxxxxxse"})})]}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"As you can see the first blocks output is the same so you can work out the first block. To then work out the second try entering:"}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:Object(a.jsx)("b",{children:"xxxxxxx"})}),Object(a.jsx)("li",{children:Object(a.jsx)("b",{children:"xxxxxxxsecure su"})})]}),Object(a.jsx)("p",{children:"This process can be repeated for for each block until all are decrypted"}),Object(a.jsx)("br",{}),Object(a.jsxs)("p",{children:["If you want to try and work this out yourself you can try with a hidden message below. It has a fixed ",Object(a.jsx)("b",{children:"IV"}),", has an alphabet of lowercase letters and space, and is 24 characters long."]}),Object(a.jsx)("p",{children:Object(a.jsx)("i",{children:"Hint: Once you have the first few characters you can start guessing what the flag is to speed up finding new characters."})}),Object(a.jsx)("br",{}),h(!0,"well done for solving it"),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{children:"This process can be automated by a script and I've written one in python that can solve this problem very fast. Below is the full code."}),Object(a.jsx)("br",{}),Object(a.jsxs)(o.a,{children:[Object(a.jsxs)("h4",{children:["responder.py ",Object(a.jsx)("i",{className:"arrow down",style:{float:"right",marginRight:"10px"}})]}),Object(a.jsx)("pre",{className:"code",children:Object(a.jsxs)("code",{children:[Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"import"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" socket"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"HOST "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:"'127.0.0.1'"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"  "}),Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# The server's hostname or IP address"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"PORT "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"65432"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# The port used by the server"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"with"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" socket."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"socket"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(socket."}),Object(a.jsx)("span",{style:{color:"rgb(228, 86, 73)"},children:"AF_INET"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:", socket."}),Object(a.jsx)("span",{style:{color:"rgb(228, 86, 73)"},children:"SOCK_STREAM"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:") "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"as"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" s:"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"s."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"connect"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"((HOST, PORT))"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"iv "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" s."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"recv"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"4096"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(1, 132, 188)"},children:"print"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:"'IV: '"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:", iv."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"hex"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"())"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"secret "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:'""'})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"block "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"0"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"decoding "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"True"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"while"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" decoding: "}),Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# decodes one block at a time"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"try"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"for"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" unknownchar "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"in"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(1, 132, 188)"},children:"range"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"): "}),Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# each unknown character in the block"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"test "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" ("}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"15"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"-"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" unknownchar) "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"*"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:'"x"'})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(1, 132, 188)"},children:"print"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:'"Testing with: "'}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" test "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" secret "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:'"_"'}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"s."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"sendall"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(iv "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" str."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"encode"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(test))"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"response "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" s."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"recv"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"4096"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"iv "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" response["}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"-"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":]"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"target "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" response[(block"}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"1"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"*"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":(block"}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"2"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"*"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"] "}),Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# block we are trying to match"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"found "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"False"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"for"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" possibleChar "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"in"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:'"ABCDEFGHIJKLMNOPQRSTUVWXYZ "'}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:": "}),Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# check all possible characters"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"message "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" ("}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"15"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"-"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" unknownchar) "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"*"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:'"x"'}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" secret "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" possibleChar "}),Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# our guess"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"s."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"sendall"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(iv "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" str."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"encode"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"(message))"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"response "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" s."}),Object(a.jsx)("span",{style:{color:"rgb(64, 120, 242)"},children:"recv"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"4096"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"iv "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" response["}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"-"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":] "}),Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# update the next iv"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"if"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" target "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"=="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" response[(block"}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"1"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"*"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":(block"}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"2"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:")"}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"*"}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"16"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"]:"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"secret "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" possibleChar "}),Object(a.jsx)("span",{style:{color:"rgb(160, 161, 167)",fontStyle:"italic"},children:"# if blocks match then char is correct"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(1, 132, 188)"},children:"print"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:'"Secret found so far: "'}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" secret)"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"found "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"True"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"break"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"if"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"not"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" found:"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"decoding "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"False"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"block "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+="}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(183, 107, 1)"},children:"1"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"except"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:":"})]}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0 \xa0 \xa0 \xa0 \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"break"})]}),"\n",Object(a.jsx)("span",{style:{display:"inline-block"},className:"line",children:Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "})}),"\n",Object(a.jsxs)("span",{style:{display:"inline-block"},className:"line",children:[Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" \xa0  "}),Object(a.jsx)("span",{style:{color:"rgb(1, 132, 188)"},children:"print"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:"("}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:'"'}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:"\\n"}),Object(a.jsx)("span",{style:{color:"rgb(80, 161, 79)"},children:'Secret: "'}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" "}),Object(a.jsx)("span",{style:{color:"rgb(166, 38, 164)"},children:"+"}),Object(a.jsx)("span",{style:{color:"rgb(56, 58, 66)"},children:" secret)"})]})]})})]})]})}}}]);
//# sourceMappingURL=3.16280001.chunk.js.map